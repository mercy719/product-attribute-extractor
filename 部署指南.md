# 产品属性提取助手 - 部署指南

## 🚀 快速部署到Railway

### 前置准备
1. **GitHub账号** - 用于代码托管
2. **Railway账号** - 用于部署服务
3. **DeepSeek API密钥** - 用于AI功能

### 第一步：上传到GitHub

1. **创建GitHub仓库**:
   - 访问 https://github.com/new
   - 仓库名称: `product-attribute-extractor`
   - 设置为公开仓库
   - 不要初始化README

2. **推送代码**:
   ```bash
   # 在项目根目录执行
   git commit -m "Initial commit: 产品属性提取助手 v1.0"

   # 添加远程仓库（替换your-username为你的GitHub用户名）
   git remote set-url origin https://github.com/your-username/product-attribute-extractor.git

   # 推送到GitHub
   git push -u origin main
   ```

### 第二步：部署到Railway

1. **登录Railway**:
   - 访问 https://railway.app
   - 使用GitHub账号登录

2. **创建新项目**:
   - 点击 "New Project"
   - 选择 "Deploy from GitHub repo"
   - 选择刚创建的仓库

3. **配置环境变量**:
   在项目的 "Variables" 标签页中添加：
   ```bash
   DEEPSEEK_API_KEY=你的DeepSeek API密钥
   SECRET_KEY=随机生成的密钥字符串
   FLASK_ENV=production
   PORT=5001
   ```

4. **选择部署配置**:
   - 选择 `Dockerfile.railway` 作为构建文件
   - 确保启动命令为: `gunicorn serve_production:app --bind 0.0.0.0:$PORT --timeout 300 --workers 2`

5. **开始部署**:
   - 点击 "Deploy" 按钮
   - 等待构建完成（通常需要5-10分钟）

### 第三步：验证部署

部署完成后，Railway会提供一个URL，访问该URL即可使用应用。

## 🔧 手动部署（VPS/Docker）

### Docker部署

1. **构建镜像**:
   ```bash
   docker build -f Dockerfile.railway -t product-extractor .
   ```

2. **运行容器**:
   ```bash
   docker run -d \
     --name product-extractor \
     -p 5001:5001 \
     -e DEEPSEEK_API_KEY="你的API密钥" \
     -e SECRET_KEY="随机密钥" \
     -v $(pwd)/uploads:/app/uploads \
     -v $(pwd)/results:/app/results \
     product-extractor
   ```

### VPS部署

1. **安装依赖**:
   ```bash
   # Python环境
   sudo apt update
   sudo apt install python3 python3-pip python3-venv

   # Node.js环境
   curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
   sudo apt-get install -y nodejs
   ```

2. **部署应用**:
   ```bash
   # 克隆代码
   git clone https://github.com/your-username/product-attribute-extractor.git
   cd product-attribute-extractor

   # 构建前端
   cd frontend
   npm install
   npm run build
   cd ..

   # 复制构建文件
   cp -r frontend/dist/* static/

   # 安装Python依赖
   python3 -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt

   # 配置环境变量
   cp .env.example .env
   # 编辑.env文件，填入你的配置

   # 启动服务
   gunicorn serve_production:app --bind 0.0.0.0:5001 --timeout 300 --workers 2
   ```

## 🌐 配置Nginx（可选）

如果需要使用Nginx作为反向代理：

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:5001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

## 🔍 故障排除

### 常见问题

1. **构建失败**:
   - 检查Node.js版本（需要>=16）
   - 确保package.json格式正确
   - 查看Railway构建日志

2. **API密钥错误**:
   - 确保DEEPSEEK_API_KEY设置正确
   - 检查API密钥是否有效

3. **端口问题**:
   - 确保PORT环境变量设置为5001
   - 检查防火墙设置

4. **文件上传失败**:
   - 检查磁盘空间
   - 确保uploads/results目录可写

### 日志查看

- **Railway**: 在项目的 "Logs" 标签页查看
- **Docker**: `docker logs product-extractor`
- **VPS**: 查看应用日志文件

## 📊 监控和维护

### 性能监控

建议配置以下监控：
- 磁盘使用情况
- 内存使用情况
- API调用次数
- 错误率统计

### 数据备份

定期备份：
- 上传的文件（uploads/）
- 处理结果（results/）
- 任务状态（tasks.json）

### 安全更新

- 定期更新依赖包
- 监控安全漏洞
- 更新API密钥

---

**部署完成后，你将拥有一个功能完整的现代化产品属性提取工具！** 🎉

如有问题，请查看Railway的构建日志或联系技术支持。